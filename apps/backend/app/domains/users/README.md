# Users / Auth

Назначение: аутентификация, идентичность пользователя, роли/права, ограничения, связь с кошельками, управление аккаунтом.

## Границы
- Владеет: учётные записи (`users`), токены (`user_tokens`), ограничения (`user_restrictions`), роли и атрибуты безопасности.
- Обладает схемой `user_profiles` (хранение locale/timezone/links/preferences), однако бизнес‑логика отображения и self‑service редактирования профиля — в домене Profile.
- Не владеет: публичный профиль и профильно‑ориентированные события — это домен Profile.

## API
- `/users/me` — данные аккаунта (id, email, роль, активность, кошелёк и т.п.).
- Профильные маршруты вынесены в домен Profile: используйте `/profile/me`, `/profile/me/settings` и `/profile/{id}`.
- Кошельки: siwe‑nonce/verify/unlink.
- Удаление аккаунта: `DELETE /users/me`.

## События
- Безопасность/аутентификация (auth.*) — зона Users.
- Профильные события (profile.*) публикует домен Profile.

## Взаимодействие с Profile
- Profile имеет ограниченный доступ на запись в `users` (только `username`, `avatar_url`, `bio`) через свой инфраструктурный репозиторий.
- Users обеспечивает инварианты идентичности (уникальность `username`, активность, ограничения) и авторизацию.

## Документы
- Спецификация среза API: `schema/openapi.yaml` (доменный срез, не основной OpenAPI проекта).
- Агент‑гайд: `agent/AGENT_GUIDE.md` и промпты в `agent/prompts/*`.
- ADR: `ADR/`.
