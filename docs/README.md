# Документация Caves

Каталог `docs/` хранит только рабочие знания: гайды по фичам, плейбуки, справочники и схемы. Журналы задач, бэклоги и временные черновики запрещены — их размещаем в таск-трекере или в `reports/<дата>/`.

## Структура каталога

| Путь | Назначение |
|------|------------|
| `features/<feature>/` | Гайды по конкретным фичам (UX, API, процессы админки). Внутри обязательно есть `README.md` или `overview.md` с кратким описанием. |
| `features/admin-ui/` | Общие правила для административных интерфейсов: сетки, взаимодействия, доступность. |
| `features/node-engagement/` | Материалы по Node Engagement (UX-гайд, API runbook). |
| `features/profile-settings/` | API и процессы управления профилями пользователей (public/admin контуры). |
| `features/moderation/` | Визия и инструкции по модерации, обновления UI. |
| `features/site-editor/` | Документация редактора сайта: модель данных, API, библиотека блоков, правила hero. |
| `frontend/` | Технические правила фронтенда (слойность, контроль зависимостей). |
| `playbooks/` | Повторяемые инженерные процессы: тестирование, аудит кода, производительность, безопасность. |
| `reference/` | Справочники и инвентаризации. Подкаталоги: `api/` (контуры, таблицы эндпоинтов, схемы, секреты), `migrations/`, `feature-flags-*.md`. |
| `adr/` | Архитектурные решения. Все документы следуют формату ADR и именуются `YYYY-MM-DD-<slug>.md`. |

Сопутствующие каталоги вне `docs/`:
- `adr/` — архитектурные решения (исторические и активные).  
- `reports/` и `var/` — хранилища артефактов, логов, экспортов. Ссылка на них указывается из соответствующего документа.

## Общие правила оформления

1. **Кодировка** — только UTF-8 без BOM. Если требуется другой формат (например, диаграмма SVG), явно указываем его в документе.
2. **Язык** — все тексты на русском. Допускаются английские названия API, сущностей и кодовые фрагменты.
3. **Формат** — каждый документ начинается с заголовка `#`, затем краткое назначение и таблица/список «что важно знать». Разделы: контекст, шаги, проверки, ссылки.
4. **Ссылки и перекрёстные связи** — используем относительные пути (`../playbooks/performance.md`). После переноса файлов обязательно обновляем ссылки.
5. **Артефакты** — в документацию добавляем только итоговые выводы и ссылки. Сырые логи, профилировки, отчёты храним в `reports/` или `var/`.
6. **Ответственность** — у каждой директории есть владелец (указан в её `README.md`). Он следит за актуальностью документов и синхронизацией с кодом.

## Процесс обновления документации

1. **Проверка существующих материалов.** Перед добавлением новой заметки ищем подходящий раздел. Если тема уже покрыта — расширяем текущий документ.
2. **Структурирование.** Для новой фичи создаём подпапку в `features/` и добавляем обзорный файл. Дополнительные материалы (UX, API, миграции) кладём рядом.
3. **Верификация.** Все команды, конфигурации и сценарии проверяются локально из корня репозитория. В документе фиксируем рабочую директорию и команды.
4. **Ссылки и ревизия.** После обновления отписываемся в связанном ADR/таске, обновляем перекрёстные ссылки (например, из плейбуков или справочников).
5. **Архивация лишнего.** Если документ устарел или дублирует другой, переносим ключевые знания в актуальный файл, а старый удаляем. Шаблоны задач и временные планы удаляются без архива.

## Быстрый путеводитель

- `features/site-editor/overview.md` — архитектура и процессы редактора сайта.  
- `features/profile-settings/README.md` — устройство API настроек профиля, контуры public/admin, SLO и аудит.  
- `features/node-engagement/api.md` и `features/node-engagement/ux.md` — руководство по админке Node Engagement.  
- `features/admin-ui/interaction-rules.md` — стандарты поведения и адаптивности админских UI.  
- `playbooks/backend-testing.md` — структура тестов и правила запуска.  
- `playbooks/code-audit.md` — как проводить аудит репозитория.  
- `playbooks/performance.md` — профилирование и контроль производительности.  
- `playbooks/security.md` — требования к защите API и управлению секретами.  
- `frontend/layering.md`, `frontend/dependency-audit.md` — правила слойности и контроля импортов.  
- `reference/api/catalog.md` и `reference/api/access-policy.md` — сводка эндпоинтов и матрица ролей.  
- `reference/feature-flags-sql.md` — runbook для SQL-флагов.

Если не уверены, куда поместить новый материал, ориентируйтесь на структуру выше или уточните у владельца каталога.
