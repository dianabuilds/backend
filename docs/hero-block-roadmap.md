# Руководство по миграции hero-блоков

Используем `PageHero` как единый шаблон для внутренних страниц. Документ замещает проектный «роадмап» и описывает, как планомерно переводить существующие блоки на новый паттерн.

## Цель
- один hero на страницу без дублей;
- унифицированные пропсы (`title`, `description`, `actions`, `metrics`, `filters`);
- корректная кодировка и локализация текстов.

## Целевая архитектура
- Базовый компонент — `apps/web/src/shared/ui/patterns/PageHero.tsx`.
- Layout'ы (`ContentLayout`, `PlatformAdminFrame` и др.) проксируют пропсы PageHero и отвечают за передачу метрик и фильтров.
- Страницы (`NodesOverviewPage`, `BroadcastsPage` и т.п.) передают только данные, не собирая hero вручную.

## Этапы миграции
1. **Инвентаризация**  
   Собираем список страниц с кастомными hero-блоками и фиксируем, какие данные/действия они показывают.
2. **Подготовка layout'а**  
   Добавляем в layout поддержку `PageHero` (вариант `metrics` или `compact`), описываем публичный API и slot'ы для фильтров.
3. **Перенос контента**  
   Переносим метрики, CTA и описание в props hero. Удаляем второй hero, если он присутствовал в странице.
4. **Обновление локализаций**  
   Переводим строки в UTF-8 и при необходимости выносим их в i18n-ресурсы.
5. **Проверка**  
   Прогоняем Chromatic, Storybook и Lighthouse (для публичных страниц), проверяем адаптивность и тёмную тему.

## Definition of Ready
- Согласованы ключевые метрики и основные CTA для конкретной страницы.
- Понятно, какие фильтры останутся в hero, а какие переедут в контент.
- Проверены зависимости layout'а (маршрутизация, приватные маршруты, доступы).

## Definition of Done
- Страница использует единый `PageHero`, без дубля в контенте.
- Метрики обновляются через существующие хуки/запросы; нет ручного обновления DOM.
- Стейт фильтров синхронизируется с URL или стором и не ломает адаптивность.
- Строки и документация сохранены в UTF-8, истории в Storybook обновлены.

## Контроль качества
- Обновляем `PageHero.docs.mdx` и Chromatic-снимки при добавлении варианта.
- Фиксируем изменения в `docs/page-hero-pattern.md`.
- Для публичных страниц снимаем Lighthouse до/после и прикладываем в `var/lighthouse-*.json`.

## Связанные материалы
- `docs/page-hero-pattern.md` — детальные правила компонента.
- `docs/admin-ui-interaction-rules.md` — общее поведение админских интерфейсов.
- ADR по конкретным разделам (контентный хаб, observability, moderation).
