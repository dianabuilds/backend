# Бриф для дизайн-команды: админка нод

## Ключевые блоки интерфейса
- Карточка ноды: счётчики просмотров/лайков, статус комментариев (pending/published/hidden/deleted/blocked), модераторские действия, дата обновления, ссылки на журналы (см. adr/2025-10-02-node-engagement.md:35-38).
- Комментарии: древовидный список, фильтры по статусу/автору/времени, быстрые действия, индикатор блокировок (см. adr/2025-10-02-node-engagement.md:40-43).
- Баны и блокировки: список банов, инициатор, причина, срок, действия "Разбанить"/"Добавить бан", виджет состояния (см. adr/2025-10-02-node-engagement.md:45-47).
- Аналитика: график просмотров по дням, суммарные лайки, распределение статусов, фильтры и экспорт CSV, задержка обновлений (см. adr/2025-10-02-node-engagement.md:49-52).
- Тесты и доступность: требования к покрытию, A11y, data-testid/data-analytics (см. adr/2025-10-02-node-engagement.md:54-57).

## Ожидания от макетов
1. Подробный layout карточки ноды с зонами действий и ссылками на журналы.
2. UX древовидных комментариев: отображение иконок статуса, inline-действий, поведения пагинации и раскрытия веток.
3. Экран банов: таблица, фильтры, модалка добавления/редактирования бана, виджет состояния.
4. Аналитический дашборд: графика, фильтры по диапазону дат, блок экспорта, индикация задержки данных.
5. Доступность: видимые focus states, aria-атрибуты для деревьев и меню, подсказки по управлению с клавиатуры.

## Решения по уточнённым вопросам
- Как визуально объединить действия модератора (bulk-операции, contextual menu, отдельная панель)? -> Выносим действия в отдельную панель модератора.
- Нужно ли показывать предупредительные состояния (rate limit, частичная блокировка) в карточке ноды? -> Не требуется.
- Формат отображения истории журналов: отдельная панель, боковая док-панель или ссылка на модалку? -> Используем панель в админке.
- Каким образом обозначить задержку данных аналитики (бейдж, tooltip, статус-бар)? -> Добавляем статус-бар с указанием задержки.

## Материалы для подготовки
- Текущие гайды: docs/ui-redesign-requirements.md (проверить сетку, типографику, кнопки).
- Существующий интерфейс /nodes/library для согласования визуального языка.

## Концепция дизайна

### Общий макет
- 12-колоночная сетка с шагом 24px на >=1440px, 16px на 768-1439px и 12px на <768px.
- Экраны /admin/nodes/:id и /admin/nodes/:id/moderation используют двуколоночную компоновку: 8 колонок под контент, 4 колонки под модераторскую панель.
- Hero-зона повторяет шаблон из гайда: H1, краткий подзаголовок, ряд KPI MetricCard с авто-переносом.

### Карточка ноды
- Первый блок основной колонки: MetricCard для views, likes, comments_status (используем поля API `views_count`, `reactions_like_count`, `comments_disabled`, `comments_locked_by`, `comments_locked_at`) с цветами primary, success, warning, neutral.
- Модераторская панель закреплена справа: Primary для Обновить статистику, Secondary для Заблокировать, Tertiary для Отключить комментарии, bulk-действия через flyout.
- Секция журналов оформлена как вертикальный timeline со статусными иконками и ссылками, открываемыми в новой вкладке.

### Комментарии
- Таб-контрол переключает режимы Дерево и Список; статусные бейджи покрывают pending, published, hidden, deleted, blocked; над лентой располагается FilterBar с сегментами и выпадающими фильтрами.
- Дерево строится компонентом TreeList с отступом 24px на уровень, бейджами статуса (pending -> warning, hidden -> neutral) и inline-меню по кнопке ... .
- Внизу списка размещается пагинация из гайда и кнопка Load more; при блокировке показывается предупреждающий banner над лентой.

### Баны и блокировки
- Таблица на всю ширину контентной колонки с полями Пользователь, Причина, Дата, Истекает, Инициатор, Статус.
- Кнопки "Разбанить" (Primary) и "Добавить бан" (Secondary) находятся в хедере; действия строк открывают модалки подтверждения.
- Боковой виджет состояния показывает тумблер включения, бейдж активных банов и справочную ссылку.

### Аналитика
- Основной график (area chart) занимает 8 колонок и содержит статус-бар с указанием задержки данных.
- Под графиком располагаются MetricCard метрик: суммарные лайки, распределение статусов, со следованием сетке (до 3 карточек в ряд).
- Фильтры включают date range picker, multi-select по авторам, чекбоксы сегментов; кнопка экспорт CSV оформлена как Secondary с иконкой download.

### Состояния и доступность
- Loading: skeleton для карточек, таблиц и графиков, повторяющий паттерны гайда.
- Empty: иконка, заголовок, описание и CTA в семействе empty-state /mailings.
- Error: inline alert внутри зоны, дополнительная кнопка Retry.
- Фокус: outline 2px #1D4ED8; элементы дерева и фильтров используют aria-expanded и aria-controls; модалки и меню полностью управляются с клавиатуры.

### Адаптивность
- На 1024px боковая панель уходит под контент и сворачивается в accordion-блоки.
- На 768px таблицы превращаются в карточки с действиями в нижней строке, фильтры переходят в одну колонку.
- На 480px график становится полноширинным, KPI уезжают в горизонтальную прокрутку, действия модератора группируются в выпадающее меню.

## Дополнительно
- API-спека: docs/api/node-engagement-admin.md
